<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Servicios asignados - Trabajador</title>
	<link rel="stylesheet" th:href="@{/css/panel.trabajador.css}">
</head>
<body>
	<header>
		<div class="logo">
			<h1>MotorEntix</h1>
		</div>
		<div class="user-info">
			<span th:if="${usuario != null}" th:text="${usuario.nombre} + ' ' + ${usuario.apellido}">Trabajador</span>
			<span th:unless="${usuario != null}">Invitado</span>
			<div class="user-avatar" th:if="${usuario != null}" th:text="${usuario.nombre.substring(0, 1)}">T</div>
			<div class="user-avatar" th:unless="${usuario != null}">I</div>
		</div>
	</header>
	<div class="container">
		<nav class="sidebar">
			<ul class="sidebar-menu">
				<li class="menu-item">
					<a th:href="@{/panel.trabajador}" class="menu-link">
						<span>ðŸ‘¤</span> Mi Perfil
					</a>
				</li>
				<li class="menu-item active">
					<a th:href="@{/trabajador/servicios-asignados}" class="menu-link">
						<span>ðŸ§°</span> Servicios asignados
					</a>
				</li>
				<li class="menu-item">
					<a th:href="@{/trabajador/agenda}" class="menu-link">
						<span>ðŸ“…</span> Agenda
					</a>
				</li>
				<li class="menu-item">
					<a th:href="@{/trabajador/historial-servicios}" class="menu-link">
						<span>ðŸ“Š</span> Historial de servicios
					</a>
				</li>
				<li class="menu-item">
					<a th:href="@{/logout}" class="menu-link">
						<span>ðŸšª</span> Cerrar SesiÃ³n
					</a>
				</li>
			</ul>
		</nav>
		<main class="main-content">
			<div class="page-header">
				<h1 class="page-title">Servicios asignados</h1>
			</div>

			<div class="inventory-page" style="padding-top:0;">
				<section class="inventory-card" style="box-shadow:none; border-radius:14px;">
					<div class="inventory-header" style="margin-bottom:1rem;">
						<div>
							<h3 class="inventory-header-title">
								<span class="icon">ðŸ§°</span>
								<span>Servicios actualmente asignados</span>
							</h3>
							<p class="inventory-subtitle">Revisa tus servicios pendientes, con su estado, cliente y vehÃ­culo asociados.</p>
						</div>
					</div>

					<div th:if="${serviciosAsignados == null} or ${#lists.isEmpty(serviciosAsignados)}"
							class="welcome-card" style="margin-top:0;">
						<p>No tienes servicios asignados en este momento.</p>
					</div>

					<div th:if="${serviciosAsignados != null} and ${!#lists.isEmpty(serviciosAsignados)}"
							style="display:grid; grid-template-columns:repeat(auto-fit, minmax(260px, 1fr)); gap:1rem;">
						<div th:each="reserva : ${serviciosAsignados}"
								style="background: var(--card-bg); border-radius:14px; padding:1rem 1.25rem; box-shadow:0 10px 25px rgba(0,0,0,0.18); border:1px solid rgba(0,191,165,0.25); position:relative; overflow:hidden;">
							<div style="display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:0.5rem;">
								<div>
									<h3 style="margin:0; font-size:1rem; font-weight:600; color:var(--text-dark);"
											th:text="${reserva.servicio != null ? reserva.servicio.nombre : 'Servicio sin nombre'}">Servicio</h3>
									<p style="margin:0.15rem 0 0; font-size:0.8rem; color:#6b7280;"
											th:text="${reserva.servicio != null ? reserva.servicio.descripcion : ''}">DescripciÃ³n</p>
								</div>
								<span class="status-indicator"
										th:text="${reserva.estado}"
										th:classappend="${#strings.equalsIgnoreCase(reserva.estado, 'activa') ? ' status-available' :
											(#strings.equalsIgnoreCase(reserva.estado, 'pendiente') ? ' status-maintenance' :
												(#strings.equalsIgnoreCase(reserva.estado, 'completada') ? ' status-available' :
													(#strings.equalsIgnoreCase(reserva.estado, 'cancelada') ? ' status-rented' : '')))}">
									Pendiente
								</span>
							</div>

							<div style="display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:0.5rem; font-size:0.82rem; color:#4b5563;">
								<div>
									<strong>Fecha</strong>
									<div th:text="${reserva.fechaReserva}">2025-01-01</div>
								</div>
								<div>
									<strong>Hora</strong>
									<div th:text="${reserva.horaReserva}">10:00</div>
								</div>
								<div>
									<strong>Cliente</strong>
									<div th:text="${reserva.usuario != null ? reserva.usuario.nombre + ' ' + reserva.usuario.apellido : 'Sin cliente'}">Cliente</div>
								</div>
								<div>
									<strong>VehÃ­culo</strong>
									<div th:text="${reserva.vehiculo != null ? reserva.vehiculo.placa + ' - ' + reserva.vehiculo.marca + ' ' + reserva.vehiculo.modelo : 'No asociado'}">VehÃ­culo</div>
								</div>
							</div>

							<div style="margin-top:0.5rem; display:flex; justify-content:space-between; align-items:center; font-size:0.75rem; color:#9ca3af;">
								<span th:text="'ID reserva: #' + ${reserva.id}">#1</span>
								<span th:if="${reserva.servicio != null && reserva.servicio.precioBase != null}"
										th:text="'Precio base: S/ ' + ${reserva.servicio.precioBase}">Precio</span>
							</div>
						</div>
					</div>
				</section>
			</div>
		</main>
	</div>
</body>
</html>
