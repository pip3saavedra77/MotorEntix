<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Editar Perfil - MotorEntix</title>
	<link rel="stylesheet" th:href="@{/css/panel.cliente.css}">
	<link rel="stylesheet" th:href="@{/css/cssPanelCliente/perfil.css}">
	<style>
		.edit-profile-layout {
			display: flex;
			flex-direction: column;
			gap: 1.5rem;
		}

		.edit-profile-card {
			background: linear-gradient(135deg, #ffffff 0%, #f4f5fb 100%);
			border-radius: 18px;
			box-shadow: 0 16px 40px rgba(0, 0, 0, 0.16);
			border: 1px solid rgba(255, 255, 255, 0.8);
			padding: 1.8rem 2.2rem;
			transition: transform 0.2s ease, box-shadow 0.2s ease;
		}

		.edit-profile-card:hover {
			transform: translateY(-2px);
			box-shadow: 0 22px 55px rgba(0, 0, 0, 0.2);
		}

		.edit-profile-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 1.25rem;
		}

		.edit-profile-title {
			font-size: 1.25rem;
			font-weight: 600;
			color: #111827;
			display: flex;
			align-items: center;
			gap: 0.5rem;
		}

		.edit-profile-title span.icon {
			font-size: 1.4rem;
		}

		.edit-profile-subtitle {
			font-size: 0.9rem;
			color: #6b7280;
			margin-bottom: 1rem;
		}

		.edit-profile-form .profile-info-grid {
			display: grid;
			grid-template-columns: repeat(2, minmax(0, 1fr));
			gap: 1rem 1.5rem;
		}

		.edit-profile-form .profile-info-item {
			display: flex;
			flex-direction: column;
			gap: 0.35rem;
		}

		.edit-profile-form .profile-info-item.full-width {
			grid-column: 1 / -1;
		}

		.edit-profile-form .input-label {
			font-size: 0.82rem;
			font-weight: 600;
			color: #4b5563;
			text-transform: uppercase;
			letter-spacing: 0.04em;
		}

		.edit-profile-form .search-input,
			.edit-profile-form textarea {
			border-radius: 0.9rem;
			border: 1px solid #d1d5db;
			padding: 0.6rem 0.85rem;
			font-size: 0.9rem;
			background-color: #f9fafb;
			transition: border-color 0.15s ease, box-shadow 0.15s ease, background-color 0.15s ease, transform 0.1s ease;
			resize: vertical;
		}

		.edit-profile-form .search-input:focus,
			.edit-profile-form textarea:focus {
			outline: none;
			border-color: #f97316;
			box-shadow: 0 0 0 2px rgba(249, 115, 22, 0.25);
			background-color: #ffffff;
			transform: translateY(-1px);
		}

		.form-actions {
			margin-top: 1.4rem;
			display: flex;
			gap: 0.9rem;
			justify-content: flex-end;
			flex-wrap: wrap;
		}

		.form-actions .btn-primary {
			border-radius: 999px;
			padding: 0.6rem 1.5rem;
			font-weight: 600;
			display: inline-flex;
			align-items: center;
			gap: 0.4rem;
			box-shadow: 0 12px 30px rgba(249, 115, 22, 0.45);
			transition: transform 0.15s ease, box-shadow 0.15s ease;
		}

		.form-actions .btn-primary:hover {
			transform: translateY(-1px);
			box-shadow: 0 18px 40px rgba(249, 115, 22, 0.6);
		}

		.form-actions .btn-secondary {
			border-radius: 999px;
			border: 1px solid #e5e7eb;
			background: #ffffff;
			color: #4b5563;
			padding: 0.55rem 1.2rem;
			font-size: 0.85rem;
			transition: background 0.15s ease, color 0.15s ease, border-color 0.15s ease;
		}

		.form-actions .btn-secondary:hover {
			background: #f3f4f6;
			border-color: #d1d5db;
			color: #111827;
		}

		@media (max-width: 900px) {
			.edit-profile-form .profile-info-grid {
				grid-template-columns: 1fr;
			}
		}
	</style>
</head>

<body>
	<header>
		<div class="logo">
			<h1>MotorEntix</h1>
		</div>
		<div class="user-info">
			<span th:if="${usuario != null}" th:text="${usuario.nombre} + ' ' + ${usuario.apellido}">Usuario</span>
			<span th:unless="${usuario != null}">Invitado</span>
			<div class="user-avatar" th:if="${usuario != null}" th:text="${usuario.nombre.substring(0, 1)}">U</div>
			<div class="user-avatar" th:unless="${usuario != null}">I</div>
		</div>
	</header>

	<div class="container">
		<nav class="sidebar">
			<ul class="sidebar-menu">
				<li class="menu-item">
					<a th:href="@{/panel.cliente}" class="menu-link">
						<span>üë§</span> Mi Perfil
					</a>
				</li>
				<li class="menu-item">
					<a th:href="@{/vehiculos-cliente}" class="menu-link">
						<span>üöó</span> Mis Veh√≠culos
					</a>
				</li>
				<li class="menu-item">
					<a th:href="@{/reservasCliente}" class="menu-link">
						<span>üìã</span> Reservas
					</a>
				</li>
				<li class="menu-item">
					<a th:href="@{/historial}" class="menu-link">
						<span>üìä</span> Historial
					</a>
				</li>
				<li class="menu-item">
					<a th:href="@{/servicios}" class="menu-link">
						<span>üîß</span> Servicios
					</a>
				</li>
				<li class="menu-item">
					<a th:href="@{/logout}" class="menu-link">
						<span>üö™</span> Cerrar Sesi√≥n
					</a>
				</li>
			</ul>
		</nav>

		<main class="main-content">
			<div class="page-header">
				<h1 class="page-title">Editar Perfil</h1>
				<a th:if="${rol != null} and ${#strings.equalsIgnoreCase(rol, 'administrador')}" th:href="@{/admin/mi-perfil}"
					class="btn btn-primary">
					<span>‚Üê</span> Volver al Perfil
				</a>
				<a th:if="${rol == null} or ${!#strings.equalsIgnoreCase(rol, 'administrador')}" th:href="@{/panel.cliente}"
					class="btn btn-primary">
					<span>‚Üê</span> Volver al Perfil
				</a>
			</div>

			<section class="edit-profile-layout">
				<div class="edit-profile-card">
					<div class="edit-profile-header">
						<div>
							<h2 class="edit-profile-title">
								<span class="icon">üìù</span>
								<span>Actualizar informaci√≥n de tu cuenta</span>
							</h2>
							<p class="edit-profile-subtitle">Modifica tus datos personales y guarda los cambios de forma segura.</p>
						</div>
					</div>

					<!-- Mensajes de √©xito/error -->
					<div th:if="${param.exito}" class="alert alert-success">
						Perfil actualizado correctamente
					</div>
					<div th:if="${error}" class="alert alert-error" th:text="${error}">
						Error al actualizar
					</div>

					<form th:action="@{/actualizar-perfil}" th:object="${usuario}" method="post" class="edit-profile-form">
						<div class="profile-info-grid">
							<div class="profile-info-item">
								<label class="input-label">Nombre</label>
								<input type="text" th:field="*{nombre}" class="search-input" required th:attr="value=${usuario.nombre}">
							</div>

							<div class="profile-info-item">
								<label class="input-label">Apellido</label>
								<input type="text" th:field="*{apellido}" class="search-input" required th:attr="value=${usuario.apellido}">
							</div>

							<div class="profile-info-item">
								<label class="input-label">Correo Electr√≥nico</label>
								<input type="email" th:field="*{correo}" class="search-input" required th:attr="value=${usuario.correo}">
							</div>

							<div class="profile-info-item">
								<label class="input-label">Tel√©fono</label>
								<input type="tel" th:field="*{telefono}" class="search-input" th:attr="value=${usuario.telefono}">
							</div>

							<div class="profile-info-item full-width">
								<label class="input-label">Direcci√≥n</label>
								<textarea th:field="*{direccion}" class="search-input" rows="3" th:text="${usuario.direccion}"></textarea>
							</div>

							<!-- Campos ocultos para mantener datos no editables -->
							<input type="hidden" th:field="*{id_usuario}">
							<input type="hidden" th:field="*{estado}">
							<input type="hidden" th:field="*{rol}">
							<input type="hidden" th:field="*{contrasena}">
						</div>

						<div class="form-actions">
							<button type="submit" class="btn btn-primary">
								<span>üíæ</span> Guardar Cambios
							</button>
							<a th:if="${rol != null} and ${#strings.equalsIgnoreCase(rol, 'administrador')}" th:href="@{/admin/mi-perfil}"
								class="btn btn-secondary">
								<span>‚ùå</span> Cancelar
							</a>
							<a th:if="${rol == null} or ${!#strings.equalsIgnoreCase(rol, 'administrador')}" th:href="@{/panel.cliente}"
								class="btn btn-secondary">
								<span>‚ùå</span> Cancelar
							</a>
						</div>
					</form>
				</div>
			</section>
		</main>
	</div>
</body>

</html>